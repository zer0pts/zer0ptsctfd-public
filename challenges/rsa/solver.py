import gmpy2
from Crypto.Util.number import *

def common_modulus_attack(c1, c2, e1, e2, n):
    gcd, s1, s2 = gmpy2.gcdext(e1, e2)
    if s1 < 0:
        s1 = -s1
        c1 = gmpy2.invert(c1, n)
    elif s2 < 0:
        s2 = -s2
        c2 = gmpy2.invert(c2, n)
    v = pow(c1, s1, n)
    w = pow(c2, s2, n)
    m = (v * w) % n
    return m

n = 23877761562933246540771931275804139261245433394321283416955824853783050037400991339615671885955693817533843439967076120484076488616316694258963552115885765613535953512750291478714283206276528898885818803070569893984493482225984379607840590862732289225854584428630452220052833815435726052799676300954132067420747323346360301926763239082116386822718860368043009699527894682202916577458192101332052019032444867210164197500231703420952324766187935191787047407195860429863860435036095361012438520588605080622969293127143045550627548880363776816230407836292517740979781061739968920965065970347228388307287930091101116071732 + 1

e1 = 43469
e2 = 657572
c1 = 13236212919548031806553691345541375207491931457677066327164654037275220195313117791941397203963315335946472240243625359953402755175443735967155794942883245976377626746135069367207639845716113690720566476697319044759109594099280892511528480695746233369928966712551099095746060808296320910005421968299545384666679664023698529405411940173373155949336679160715432406699023939006135574156185121414205326955657855703724713030816198645350287216914693119585934223438894251419439431975075450804375990440981473226830197518475008043219512369052243906132404954324316124003405527057734503437404653419891122061911150512101834910049
c2 = 19647902143914076580666861853700744300793780666865860648195449327626013678287525361671231788027190529252236700152145280669432834276653167666857257055250023790002005435409185104235473366554388892980328856041170756070481279349784554130206183741626496950184912985354087713971714790804878850561013702827533496531614588549964640524821166981694028492819187218014807788724639145467428002125964619623940371041089560267900577508589059269050512751479644038868497632445046709915675090622905646793097701608626799325111042899759533368867021766576368524706582312615271081085604241420023027493902410637071869183958279518443173352534

m = common_modulus_attack(c1, c2, e1, e2, n)
print(long_to_bytes(m))
